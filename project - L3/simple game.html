<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Rasyid Adventure</title>
  <style>
    body { text-align: center; background: #111; color: white; font-family: Arial; }
    canvas { background: #333; display: block; margin: auto; border: 3px solid white; }
    #hud { margin-top: 10px; }
    .bar {
      height: 20px; background: red; border: 2px solid white; width: 200px;
      margin: auto; margin-bottom: 10px; position: relative;
    }
    .bar-inner {
      height: 100%; background: lime; width: 100%;
    }

  .back-mini { position:fixed; left:16px; bottom:16px; width:40px;height:40px;border-radius:50%; display:flex; align-items:center; justify-content:center; background:transparent; border:1px solid rgba(176,140,255,0.12); color:var(--accent2); text-decoration:none; z-index:60; box-shadow:0 8px 22px color(srgb-linear red green blue) }
  .back-mini:hover{ transform:scale(1.06); background:linear-gradient(90deg,var(--accent2),var(--accent1)); color:blueviolet }

  </style>
</head>
<body>
  <a class="back-mini" href="index.html" title="Kembali">‚Üê</a>
  <h1>‚öî Rasyid Adventure ‚öî</h1>
  <div class="bar"><div id="hpBar" class="bar-inner"></div></div>
  <canvas id="gameCanvas" width="600" height="400"></canvas>
  <div id="hud">
    <p>HP: <span id="hp">100</span> | Skor: <span id="score">0</span> | Level: <span id="level">1</span></p>
  </div>

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    let gameOver = false;
    let win = false;

    // Player
    let player = { x: 50, y: 50, size: 20, color: "lime", hp: 100 };

    // Map obstacles (tembok)
    let walls = [
      { x: 100, y: 100, w: 80, h: 20 },
      { x: 300, y: 200, w: 100, h: 20 },
      { x: 200, y: 300, w: 20, h: 80 }
    ];

    // Item (coin)
    let items = [
      { x: 150, y: 50, size: 15, taken: false },
      { x: 400, y: 150, size: 15, taken: false },
      { x: 500, y: 300, size: 15, taken: false }
    ];

    // Musuh
    let enemies = [
      { x: 250, y: 150, size: 20, color: "red", dx: 2, dy: 2, type: "patrol" },
      { x: 450, y: 200, size: 20, color: "orange", dx: 1, dy: 1, type: "chase" }
    ];

    let score = 0;
    let level = 1;

    // Gerakan player
    document.addEventListener("keydown", movePlayer);
    function movePlayer(e) {
      if (gameOver || win) return;
      let oldX = player.x, oldY = player.y;
      if (e.key === "ArrowUp") player.y -= 10;
      if (e.key === "ArrowDown") player.y += 10;
      if (e.key === "ArrowLeft") player.x -= 10;
      if (e.key === "ArrowRight") player.x += 10;

      // Cek tabrakan tembok
      for (let wall of walls) {
        if (isColliding(player, wall)) {
          player.x = oldX;
          player.y = oldY;
        }
      }
    }

    // Update Musuh
    function updateEnemies() {
      enemies.forEach(enemy => {
        if (enemy.type === "patrol") {
          enemy.x += enemy.dx;
          enemy.y += enemy.dy;
          if (enemy.x < 0 || enemy.x + enemy.size > canvas.width) enemy.dx *= -1;
          if (enemy.y < 0 || enemy.y + enemy.size > canvas.height) enemy.dy *= -1;
        } else if (enemy.type === "chase") {
          if (player.x > enemy.x) enemy.x += 1;
          if (player.x < enemy.x) enemy.x -= 1;
          if (player.y > enemy.y) enemy.y += 1;
          if (player.y < enemy.y) enemy.y -= 1;
        }

        if (isColliding(player, enemy)) {
          player.hp -= 1;
          if (player.hp <= 0) gameOver = true;
        }
      });
    }

    // Update Item
    function updateItems() {
      items.forEach(item => {
        if (!item.taken && isColliding(player, item)) {
          item.taken = true;
          score += 10;
          if (score >= 30) nextLevel();
        }
      });
    }

    // Next Level
    function nextLevel() {
      level++;
      if (level === 2) {
        items = [
          { x: 100, y: 50, size: 15, taken: false },
          { x: 300, y: 200, size: 15, taken: false },
          { x: 550, y: 350, size: 15, taken: false }
        ];
        enemies.push({ x: 200, y: 100, size: 25, color: "purple", dx: 2, dy: -2, type: "patrol" });
      } else if (level === 3) {
        enemies = [{ x: 250, y: 150, size: 50, color: "darkred", dx: 2, dy: 2, type: "chase" }];
        items = [{ x: 500, y: 200, size: 20, taken: false }];
      }
    }

    // Cek tabrakan
    function isColliding(a, b) {
      return a.x < b.x + (b.w || b.size) &&
             a.x + a.size > b.x &&
             a.y < b.y + (b.h || b.size) &&
             a.y + a.size > b.y;
    }

    // Render
    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Walls
      ctx.fillStyle = "gray";
      walls.forEach(wall => ctx.fillRect(wall.x, wall.y, wall.w, wall.h));

      // Player
      ctx.fillStyle = player.color;
      ctx.fillRect(player.x, player.y, player.size, player.size);

      // Items
      ctx.fillStyle = "gold";
      items.forEach(item => {
        if (!item.taken) ctx.fillRect(item.x, item.y, item.size, item.size);
      });

      // Musuh
      enemies.forEach(enemy => {
        ctx.fillStyle = enemy.color;
        ctx.fillRect(enemy.x, enemy.y, enemy.size, enemy.size);
      });

      // HUD
      document.getElementById("hp").textContent = player.hp;
      document.getElementById("score").textContent = score;
      document.getElementById("level").textContent = level;
      document.getElementById("hpBar").style.width = Math.max(player.hp, 0) + "%";

      // Game Over / Win
      if (gameOver) {
        ctx.fillStyle = "white";
        ctx.font = "30px Arial";
        ctx.fillText("üíÄ GAME OVER üíÄ", 200, 200);
      }
      if (level === 3 && score >= 40) {
        win = true;
        ctx.fillStyle = "yellow";
        ctx.font = "30px Arial";
        ctx.fillText("üèÜ YOU WIN! üèÜ", 220, 200);
      }
    }

    // Loop Game
    function gameLoop() {
      if (!gameOver && !win) {
        updateEnemies();
        updateItems();
      }
      draw();
      requestAnimationFrame(gameLoop);
    }

    gameLoop();
  </script>
</body>
</html>